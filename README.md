# Инструкция по запуску приложения

1. Склонировать репозиторий:
   ```git clone https://github.com/RuslanBeresnev/Conveyor-Belt-Monitoring-Web-Application```
2. Создать виртуальное окружение ```.venv``` в проекте
3. Установить все зависимости из ```requirements.txt```:
   ```
   python -m pip install --upgrade pip
   pip install -r requirements.txt
   ```
4. Загрузить СУБД PostgreSQL: https://www.postgresql.org/download/
При установке можно отметить дополнительный чек-бокс с графической утилитой "pgAdmin 4"
5. Добавить путь до консольной утилиты psql.exe в переменную PATH: ```C:\Program Files\PostgreSQL\17\bin```
6. Скачать архив: https://drive.google.com/file/d/1Z5rEbuojpTs-UW7sXqcW73HDqdfr5s5z/view?usp=sharing
   Ввести пароль доступа для распаковки архива (пароль выдаётся только для проверки производственной практики)
7. Поместить файл ```client_secret.json``` в корневую директорию проекта - это необходимо для дальнейшей аутентификации через Google для отправки писем с тестового аккаунта
8. В корневой директории репозитория создать файл ```.env``` вида:
    ```
    TELEGRAM_BOT_TOKEN = "<token from file>"
    DATABASE_URL = "postgresql://<user>:<password>@localhost:5432/<DB_name>"
    GMAIL_ADDRESS = "<Your Gmail to get emails>@gmail.com"
    ```
9. Выполнить вход в тестовый аккаунт Google (почта и пароль так же находятся в запороленном архиве)
10. Запустить сервер через терминал (из корня репозитория):
    ```
    fastapi dev application/main.py
    ```
11. Открыть страницу со сгенерированной документацией (формат OpenAPI): http://127.0.0.1:8000/docs
12. Вызвать эндпоинт ```/maintenance/create_tables``` для создания таблиц и триггеров в БД
13. Вызвать эндпоинт ```/maintenance/fill_database``` для заполнения таблицы необходимыми и тестовыми данными
14. Протестировать вызовы различных эндпоинтов, например:
- ```/notification/with_telegram``` перед первым запросом требует предварительной отправки сообщения Telegram-боту ```@conveyor_belt_notification_bot```, чтобы зарегистрировать чат с пользователем (сообщения бота будут отправляться последнему пользователю, который отправил любое сообщение боту)
- ```/notification/with_gmail``` во время первого запроса при аутентификации необходимо выбрать тестовый аккаунт Google, указанный выше
15. Нажать ```Ctrl + C``` для остановки сервера и завершения работы приложения
16. <Опционально> Запустить линтер в консоли из корня репозитория:
    ```
    pylint ./**/*.py --disable=C0301,C0114,C0115,C0116
    ```
    (отключены предупреждение о превышении длины строки в 100 символов и предупреждение об отсутствии документации у модулей, классов и некоторых функций)
17. <Опционально> Запустить тесты в консоли из корня репозитория:
    ```
    pytest tests
    ```
