# Инструкция по запуску веб-приложения

1. Скачать и установить Docker Desktop вместе с Docker (для дальнейшего использования необходимо наличие аппаратной виртуализации на компьюьере): https://www.docker.com/
2.  Склонировать репозиторий:
   ```git clone https://github.com/RuslanBeresnev/Conveyor-Belt-Monitoring-Web-Application```
3. Скачать архив: [https://drive.google.com/file/d/1Z5rEbuojpTs-UW7sXqcW73HDqdfr5s5z/view?usp=sharing](https://drive.google.com/file/d/1bXZM1BW8DELQIq20fjLxudVZv0XpEFCf/view?usp=sharing)
   Ввести пароль доступа для распаковки архива (пароль выдаётся только для проверки ВКР)
4. Поместить файл ```token.json``` в корневую директорию проекта - это необходимо для отправки писем с Gmail-аккаунта conveyor.belt.notification@gmail.com
5. В корневой директории репозитория создать файл ```.env``` вида:
    ```
    CLIENT_ADDRESS="localhost"
    CLIENT_PORT="3000"
    TELEGRAM_BOT_TOKEN = "<токен из .txt-файла из архива>"
    DATABASE_URL = "postgresql://postgres:1010@db:5432/TestDB"
    GMAIL_ADDRESS = "<ваш gmail для получения писем>@gmail.com"
    TELEGRAM_USER_NAME = ""
    TELEGRAM_USER_CHAT_ID = ""
    ```
   Параметры ```TELEGRAM_USER_NAME``` и ```TELEGRAM_USER_CHAT_ID``` нужно оставить пустыми (то есть написать только "") - они будут заполнены автоматически при первой отправке сообщения ботом
6. В директории ```/ui``` также создать файл ```.env```:
    ```
    REACT_APP_SERVER_ADDRESS=localhost
    REACT_APP_CONNECTION_PORT=8000
    ```
7. В консоли перейти в корневую папку проекта ```Conveyor-Belt-Monitoring-Web-Application```
8. Создать docker-образы с помощью команды ```docker-compose build``` (это может занять несколько минут)
9. Создать и запустить docker-контейнеры с помощью команды ```docker-compose up -d```
10. Отправить любое сообщение боту ```@conveyor_belt_notification_bot``` в Telegram, чтобы зарегистрировать в веб-приложении id чата с ним
11. Перейти в браузере по адресу http://localhost:3000/ - откроется раздел веб-приложения с информацией о дефектах, но в нём пока ничего не будет, потому что таблицы базы данных ещё не созданы. Из-за этого же могут появляться ошибки, но это нормально на данном этапе
13. Перейти в раздел ```Settings``` и создать таблицы базы данных, а также заполнить их необходимыми данными, нажав на кнопки ```RECREATE DB``` и ```FILL DB```
14. Теперь веб-приложение готово к использованию
15. При необходимости можно перейти по адресу http://localhost:8000/ для взаимодействия с эндпоинтами сервера через OpenAPI-документацию
16. В Docker Desktop доступны логи клиента и сервера в разделе Containers - их можно посмотреть при необходимости (например, если возникнут ошибки)
17. Для остановки работы веб-приложения необходимо остановить все контейнеры с помощью команды ```docker-compose stop``` (либо из Docker Desktop). Информация в базе данных сохранится (в Docker Desktop в разделе Volumes).
18. Для повторного запуска веб-приложения необходимо запустить контейнеры с помощью команды ```docker-compose start``` (либо из Docker Desktop)
19. <Опционально> Можно запустить линтер в консоли из корня проекта с помощью команды:
    ```
    pylint ./**/*.py --disable=C0301,C0114,C0115,C0116
    ```
    (отключены предупреждение о превышении длины строки в 100 символов и предупреждение об отсутствии документации у модулей, классов и некоторых функций)
20. <Опционально> Можно запустить тесты в консоли из корня проекта с помощью команды:
    ```
    pytest tests
    ```
